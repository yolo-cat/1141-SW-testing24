# extractRuns() 方法的 JUnit 單元測試說明

## 測試檔案位置
`src/test/java/xdemo/PlayByPlayAnnouncerTest.java`

## 測試目的
針對 `extractRuns()` 方法進行單元測試，確保能正確從棒球速記代碼中提取得分數。

---

## 核心需求測試

### ✅ 測試 1: extractRuns("2B 1R") ⇒ 應回傳 1
- **測試目的**: 驗證能正確提取二壘安打帶 1 分的情況
- **預期結果**: 回傳 1
- **能找出的錯誤**:
  - 沒有正確解析 "1R" 格式
  - 回傳了錯誤的數字（如 2）
  - 忽略了空格後的得分資訊

### ✅ 測試 2: extractRuns("K") ⇒ 應回傳 0
- **測試目的**: 驗證三振事件沒有得分
- **預期結果**: 回傳 0
- **能找出的錯誤**:
  - 沒有處理無得分的情況，回傳 null 或拋出例外
  - 錯誤地從 "K" 中提取出數字
  - 預設值不是 0

---

## 擴展測試案例

| 測試案例 | 輸入 | 預期輸出 | 測試目的 |
|---------|------|---------|---------|
| 3 | "HR 3R" | 3 | 驗證全壘打多分得分 |
| 4 | "BB" | 0 | 驗證保送無得分 |
| 5 | "BB 1R" | 1 | 驗證保送擠回 1 分 |
| 6 | "3B 1R" | 1 | 驗證三壘安打帶 1 分 |
| 7 | "1B" | 0 | 驗證一壘安打無得分 |
| 8 | "2B 2R" | 2 | 驗證二壘安打帶 2 分 |
| 9 | "F8" | 0 | 驗證高飛接殺無得分 |
| 10 | "6-3" | 0 | 驗證滾地球出局無得分 |

---

## 邊界測試（找出潛在錯誤）

### 測試 11: extractRuns("HR 4R") ⇒ 應回傳 4
- **測試目的**: 驗證能處理滿貫全壘打（4分）
- **能找出的錯誤**: 只能處理 1-3 分的情況

### 測試 12: extractRuns("") ⇒ 應回傳 0
- **測試目的**: 驗證能處理空輸入
- **能找出的錯誤**: 拋出 NullPointerException 或其他例外

### 測試 13: extractRuns("2B 10R") ⇒ 應回傳 10
- **測試目的**: 驗證能處理兩位數的得分
- **能找出的錯誤**: 只能處理個位數，或錯誤地只取第一位數字

### 測試 14: extractRuns("WTF") ⇒ 應回傳 0
- **測試目的**: 驗證能處理無效的速記代碼
- **能找出的錯誤**: 拋出例外而不是回傳 0

---

## 執行測試

```bash
# 執行所有測試
mvn test -Dtest=PlayByPlayAnnouncerTest

# 執行特定測試
mvn test -Dtest=PlayByPlayAnnouncerTest#testExtractRuns_2B1R_ShouldReturn1
```

---

## 測試結果

✅ **所有 14 個測試都通過**

```
Tests run: 14, Failures: 0, Errors: 0, Skipped: 0
```

---

## 如何透過測試找出錯誤

### 範例 1: 錯誤的正則表達式

假設 `extractRuns()` 的實作有誤：

```java
// ❌ 錯誤實作：忘記轉義 R
private static int extractRuns(String event) {
    Pattern pattern = Pattern.compile("(\\d+)R");  // 正確
    // Pattern pattern = Pattern.compile("(\\d+)"); // 錯誤：會匹配到 "2B" 中的 2
    Matcher matcher = pattern.matcher(event);
    return matcher.find() ? Integer.parseInt(matcher.group(1)) : 0;
}
```

**測試會失敗**:
- `testExtractRuns_2B1R_ShouldReturn1()` 會失敗，因為會錯誤地提取到 "2" 而不是 "1"
- `testExtractRuns_K_ShouldReturn0()` 仍會通過

### 範例 2: 沒有預設值

```java
// ❌ 錯誤實作：沒有預設值
private static int extractRuns(String event) {
    Pattern pattern = Pattern.compile("(\\d+)R");
    Matcher matcher = pattern.matcher(event);
    return Integer.parseInt(matcher.group(1)); // 沒有 find() 檢查
}
```

**測試會失敗**:
- `testExtractRuns_K_ShouldReturn0()` 會拋出 `IllegalStateException`
- `testExtractRuns_EmptyString_ShouldReturn0()` 會拋出例外

### 範例 3: 只處理個位數

```java
// ❌ 錯誤實作：只匹配個位數
private static int extractRuns(String event) {
    Pattern pattern = Pattern.compile("([0-9])R"); // 只匹配一位數
    Matcher matcher = pattern.matcher(event);
    return matcher.find() ? Integer.parseInt(matcher.group(1)) : 0;
}
```

**測試會失敗**:
- `testExtractRuns_2B10R_ShouldReturn10()` 會失敗，只會回傳 1 而不是 10

---

## 總結

這個測試套件包含：
- ✅ 2 個核心需求測試（符合題目要求）
- ✅ 8 個擴展測試（覆蓋常見情況）
- ✅ 4 個邊界測試（找出潛在錯誤）

**總共 14 個測試案例**，能有效找出 `extractRuns()` 方法的各種實作錯誤。
